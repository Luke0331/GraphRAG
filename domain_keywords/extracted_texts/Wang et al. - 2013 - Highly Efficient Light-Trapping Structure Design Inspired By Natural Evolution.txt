Highly Efficient Light-Trapping Structure Design Inspired By Natural Evolution Chen Wang*, Shuangcheng Yu*, Wei Chen & Cheng Sun Mechanical Engineering Department, Northwestern University, Evanston, Illinois 60208, USA. Recent advances in nanophotonic light trapping open up the new gateway to enhance the absorption of solar energy beyond the so called Yablonovitch Limit. It addresses the urgent needs in developing low cost thin-film solar photovoltaic technologies. However, current design strategy mainly relies on the parametric approach that is subject to the predefined topological design concepts based on physical intuition. Incapable of dealing with the topological variation severely constrains the design of optimal light trapping structure. Inspired by natural evolution process, here we report a design framework driven by topology optimization based on genetic algorithms to achieve a highly efficient light trapping structure. It has been demonstrated that the optimal light trapping structures obtained in this study exhibit more than 3-fold increase over the Yablonovitch Limit with the broadband absorption efficiency of 48.1%, beyond the reach of intuitive designs. S olar radiation provides an abundant supply of free energy in nature. Efficient utilization of solar energy could address the most urgent problem facing the industrialized world for its reliance on fossil fuels to generate electricity. Light trapping was therefore developed to extend the path-length for light interacting with the active layer, so high-efficiency thin film solar cell can be created using much less active materials with the benefit of cost reduction. However, as the active layer becomes notably thinner than the wavelength of the light, the statistic ray-optics approximation used to derive the Yablonovitch Limit1 no longer holds24. Instead, the evanescent wave can contribute to substantially enhance the absorption of the solar energy, resulting in the improved performance beyond such a classical limit5,6. As an example, Yu et al. reported a maximum absorption enhancement factor of 1234n2 at a single wavelength by designing a nanostructured dielectric grating that couples the incident light to a 5 nm thick slot waveguide modes using weak absorbing active medium5. Similarly, a wide range of periodic light trapping structures have been reported, such as triangular or pyramid grating7,8, nanoparticles9, nanowires4, nanoholes10, nanocones11, photonic crystals12,13, and plasmonic nano- structures1417. Pursuing the optimal light trapping techniques requires a careful consideration of the competing physical processes, including light refraction, deflection, and absorption. However, these works are conducted in an ad-hoc fashion that relies on physical intuition to predefine the topology of the light-trapping structure and thus, not capable of handling the topological variation in reaching the optimal design. Therefore, it calls for a general, yet systematic methodology that is capable of seeking the optimal topology in delivering highly efficient light trapping designs beyond intuition. While facing challenges in designing effective topology for functionalities, through billions of years of evolu- tion, nature often presents its unique but surprisingly elegant solutions that far excel the modern engineering designs18,19. For instance, the nature-created topology in moths compound eyes, which consists of a hexagonal arrays of nipples, act as an anti-reflection coating (ARC) with gradual refractive index profile2022; diatoms have the unique hierarchical periodic structures in the frustule to diffract incoming light for efficient energy harvest- ing23, long before the concept of photonic crystals (PhCs) was ever conceived. Inspired by the natural evolution process, we report a new methodology for designing nanophotonic light trapping structures by adopting the topology optimization approach for problem formulation and the genetic algorithm as the search algorithm. Topology optimization was originally developed for solving mechanical structure design problems2426. The underlying idea of conventional topology optimization is to recast a structural design problem as a material distribution optimization problem such that an optimized geometric configuration fulfills a prescribed set of performance targets. Within the last decade, this approach has been successfully extended to various photonic design problems27, such as 2D photonic crystal band-gap maximization2830, low-loss photonic waveguide design31, design of photonic structure for light confinement32 and invisibility cloak optimization33. Innovative and optimal structures are obtained for these problems by using topology optimization methods. Nevertheless for SUBJECT AREAS: OPTICAL MATERIALS AND STRUCTURES NANOPHOTONICS AND PLASMONICS OPTICAL PHYSICS SOLAR ENERGY AND PHOTOVOLTAIC TECHNOLOGY Received 17 September 2012 Accepted 20 November 2012 Published 3 January 2013 Correspondence and requests for materials should be addressed to W.C. (weichen@ northwestern.edu) or C.S. (c-sun@ northwestern.edu) * These authors contributed equally to this work. SCIENTIFIC REPORTS | 3 : 1025 | DOI: 10.1038/srep01025 1 the complex light-trapping problem in thin-film cells, limited work has been conducted utilizing topology optimization to achieve effi- cient designs. Results Methodology and test model of thin film solar cell. Topology optimization methods can be generally categorized into two classes based on whether gradient information is used in searching the optimal solution, i.e. gradient-based topology optimization (GTO) methods3436 and nongradient-based topology optimization (NGTO) methods3739. The complexity of solution space in light-trapping structure design problems impairs the guidance provided by local gradients for global optimum, i.e., solutions from GTO are often trapped at local optimum of inferior performance. Under this circumstance, NGTO is more competent in searching for high performance designs by using the global search techniques. Genetic algorithm (GA) based NGTO is used in this work to optimize the geometry (topology) of the optical scattering layer to achieve highly efficient light-trapping structures. Mimicking the natural evolution with the underlying idea of survival-of-the- fittest, GA is a stochastic global search approach40,41 that involves iterative operations of selection, recombination (crossover) and mutation on a population of designs. Owing to their competency for highly nonlinear problems and convenience for parallel com- puting, GAs have been widely applied in photonics design28,32,42,43. For design evaluations, the Rigorous Coupled Wave Analysis (RCWA) method44,45, which is efficient in evaluating diffraction efficiencies of optical gratings and multilayer stacks13, is adopted in this work to numerically calculate the absorption in the active layer. In RCWA, Fourier expansions of both the field and the permittivity lead to an algebraic eigenvalue system for each layer, one of which is the light scattering layer44. The electromagnetic fields in each layer are determined by solving the eigenvalue problems. The boundary conditions are then applied in sequence at the interfaces to yield the reflected, transmitted and diffracted field amplitudes45. Therefore, the absorption of each design can be calculated by the law of energy conservation. As shown in Figure 1(a), the test structure of thin-film organic solar cells consists of a 10 nm thick P3HT:PCBM active layer that is sandwiched between two 100 nm thick cladding layers made of high index gallium phosphide (GaP), and a nano-structured light scatter- ing layer on top5,6. The scattering layer couples the incident sunlight to the corresponding slot waveguide modes by matching the differ- ences in wave vectors. The optical field will then be confined within the active layer by the virtue of the slot waveguide effect46. In this process, the scattering layer plays a critical role in balancing the competing process of light reflection at the front interface due to the impedance mismatch and the light diffraction for effective coup- ling to the slot waveguide modes. For such a coupled physical pro- cess, it is difficult to find the optimal light scattering layer design through prior structural fixation based on intuition5,47. To formulate this design problem as a dielectric material distribution optimization problem, the design space, i.e. one unit cell of the scattering layer, is discretized by a 32-by-32 finite element mesh shown in Figure 1(b). Design variables are material assignments in each discretized ele- ment, taking binary values of either 0 or 1 representing air or dielec- tric material, respectively. The unit cell size is selected to be 600 nm. The selection of the dielectric material is either a typical polymer with n51.7 or GaP with n53.57. The complex refractive index of the P3HT:PCBM active layer is set to be 1.910.156i in the optimization48. With the cell architecture shown in Fig. 1(c), the light scattering layer is optimized using GA based NGTO. Since the invention of GA method in 197540, a wild array of variants of the original GA have been developed. In this work the standard GA41 is used, which is a mature approach with proved satisfactory performance in solving relevant nanophotonic problems28,29,32. As shown in Eq. (1), the Unit Cell - Crosssection View Unit Cell - Top View 600 nm 600 nm Cladding (100 nm) Cladding (100 nm) Active Layer (10 nm) Scattering Layer (100 nm) 600 nm Unit Cell (a) (b) (c) Figure 1 | Light-trapping structure of the test case for optimization. (a) The test structure consists of a 10 nm thick P3HT:PCBM active layer that is sandwiched between two 100 nm thick cladding layers made of high index material, and a nano-structured light scattering layer on top. The scattering layer has periodicity 600 nm. The material of the scattering layer is either air or a dielectric, which is GaP or polymer with refractive index 1.7, as two different test cases. (b) The unit cell of the real space scattering pattern discretized with 32|32 meshes. Green corresponds to high-index dielectric material and white regions are air. (c) The cross-section view of the unit cell of the light trapping structure. www.nature.com/scientificreports SCIENTIFIC REPORTS | 3 : 1025 | DOI: 10.1038/srep01025 2 optimization objective is to maximize light absorption coefficient in the active layer: max : A e ð Þ I{R e ð Þ{T e ð Þ{D e ð Þ I ; ð1Þ where A is the absorption coefficient, R is the zeroth-order reflection, T is the zeroth-order transmission, D is deflection that consists higher order reflection and transmission and e is the permittivity distribution to be optimized. No constraint on material consumption is applied owing to the fabrication flexibility. The optimization framework is shown in Fig. 2(a), while Fig. 2(b) schematically illustrates the operation principle of selection, cross- over, and mutation in GA. For the purpose of demonstration, a population of 6 individual topological designs is assumed with each of these designs represented by the 4|4 elements (each element is known as a gene in GA). In this process, an initial generation con- taining a population of random designs is first created (as the num- bered designs (1,1,6) in Fig. 2(b)) and their fitness values are determined by absorption coefficient evaluated using the RCWA method. After obtaining the absorption performance of each design in the population, promising individuals with higher fitness values are selected with better chance for reproduction. As shown in Fig. 2(b), designs (1,2), (1,3), (1,4), (1,5) are selected to form the mating pool, i.e. designs (2,1,6), following the idea of survival-of- the fittest, while designs (1,2) and (1,5) are selected twice respectively due to their superior performance. The selected designs then undergo recombination also known as crossover, involving a struc- tured, yet randomized exchange of parental traits. In Fig. 2(b), three mating pairs are randomly picked from the mating pool, i.e. designs (2,1) and (2,3), designs (2,2) and (2,4), and designs (2,3) and (2,6), each of the pairs produces two offsprings, i.e. designs (3,1) and (3,2), designs (3,3) and (3,4) and designs (3,5) and (3,6), respectively. During crossover, genes of a mating pair at the same loci switch with each other stochastically, such as the highlighted gene loci in designs (2,1) and (2,3). After the crossover, genes in each design may mutate to their opposite phase at a very small probability for potential local refinements which is hard to achieve through crossover. As an illus- tration in Fig. 2(b), designs (4,1) and (4,6) are obtained from designs (3,1) and (3,6), respectively with mutations at the highlighted gene loci, while the rest designs remain the same. Absorption coefficient values of the new-born generation (designs (4,1,6) in Fig. 2(b)) are then re-evaluated. This optimization loop iterates until the final con- vergence when all designs within the population tend to be similar and their absorption performance are significantly improved. This stochastic search process mimicking the biological evolution is robust to the nonlinearity of this problem. For an optimization prob- lem with a complex solution space, regularization techniques, such as filtering techniques (Fig. 2 (a)), are required to ensure the solution existence49. The 1st test case for optimization at single wavelength. In the first optimization case, to simplify design problem associate with multiple governing factors, which often result in a complex solution space with numerous local optima, the low refractive index polymer material (n51.7) was used to construct the scattering layer. Under the effective medium approximation, the effective refractive index of the scattering layer is determined by averaging the dielectric and air regions50, ranging from 1 to 1.7, which is much smaller than that of (3,2) (3,1) (2,6) (2,5) (2,4) (2,3) (2,2) (2,1) (1,6) (1,5) (1,4) (1,3) (1,2) (1,1) (3,3) (3,4) (3,5) (4,1) (4,2) (4,3) (4,4) (4,5) (4,6) Optimized design Selection Initial generation creation (a population of random designs) g = 1 Crossover g = g+1 Light absorption evaluation by RCWA g İ gMAX Density filtering osso Geometry Representation Rep ty fi ption lecti g = g+1 Light abs De Geomet timiz (a) (b) Mutation Selection Crossover Mutation (3,6) Figure 2 | Genetic algorithm based topology optimization for light-trapping structure design. (a) The flowchart of Genetic Algorithm (GA) based topology optimization. 2D scattering pattern is represented with bit-array and rigorous coupled wave analysis (RCWA) is adopted to evaluate the absorption coefficient for each design. Designs are then optimized based on the corresponding absorption coefficients using GA that consists of selection, crossover, and mutation. The density filtering technique is utilized to treat numerical instabilities. (b) Schematic illustration of a typical operation of selection, crossover, and mutation of GA within one evolving iteration. An initial generation of 6 individual designs (1,1,6) with 4|4 elements is first created. Each element is known as a gene in GA. Designs (1,2), (1,3), (1,4), (1,5) with superior performance are selected to form the mating pool, i.e. designs (2,1,6). While designs (1,2) and (1,5) have been selected twice respectively due to their outstanding performance and keeping population constant. Then three mating pairs are randomly picked from the mating pool and each pair generates two offsprings, i.e. ((2,1), (2,3))? ((3,1), (3,2)), ((2,2), (2,4)) ?(3,3), (3,4)), ((2,3), (2,6)) ?((3,5), (3,6)), respectively. During the crossover, genes of a mating pair at the same loci switch with each other stochastically, such as the highlighted gene loci in designs (2,1) and (2,3), and result in the highlighted gene loci in designs (3,1) and (3,2). After the crossover, genes in each design may mutate to their opposite phase at a certain probability. Designs (4,1) and (4,6) are obtained from designs (3,1) and (3,6) respectively with mutations at the highlighted gene loci, while the rest designs remain the same. www.nature.com/scientificreports SCIENTIFIC REPORTS | 3 : 1025 | DOI: 10.1038/srep01025 3 the cladding layer (3.75). Therefore, the reflection at the top surface due to the impedance mismatch becomes insensitive to the variation of the scattering layer while leaving the diffraction and the subsequent mode coupling being the dominating factors in the optimization process. This step allows us to validate the design methodology using the less complicated physical process. The D2 symmetry is imposed upon the unit cell of scattering layer for reducing the computational cost of topology optimization. Optimization starts from the initial generation composed of random designs as shown in Fig. 3(a), (b). The scattering patterns that max- imize the absorptions of 400 nm, 500 nm and 600 nm for normal incidence are shown in Fig. 3(d) and (e), (g) and (h), (j) and (k), respectively. Starting from a random structure, the optimization converges to periodic and symmetric structures, which illustrates the strength of topology optimization as a powerful structural optim- ization tool. The optimized scattering structures converge to evident periodical patterns as one would expect for coupling of incident plane wave to the discrete photonic modes. Similar structures can be found in many of the light trapping structure design in the literat- ure4. The results are also illustrated by Fourier transformations of the scattering patterns, shown in Fig. 3(c), (f), (i) and (l), with the circles representing the first two fundamental TM modes supported in the slot waveguide for each wavelength. These in-plane wave vectors are determined as the result of scattering layer under normal incidence. In Fig. 3(f), (i) and (l), the overlap between the modes and coupling channels provided by the scattering layer manifests the effective mode couplings. In comparison, the initial random pattern shown in Fig. 3(c) does not provide any strong effective coupling channels. Absorption coefficient of the initial patterns and optimized patterns for incident wavelength l 5 400 nm, 500 nm and 600 nm are sum- marized in Table 1. It should be noted that the optimized absorption for 500 nm incidence is low compared with the other wavelengths due to the deconstructive interference in this multi-layered structure. Interestingly, starting from a random pattern, the natural inspired topology optimization process leads to the well-defined scattering structures featuring distinguished scattering orders that match the discrete slot waveguide modes. Furthermore, it is worthwhile to note that the optimized results exhibit appreciable topological variations, suggesting the potential to use this method for searching the optimal light trapping structure beyond a pre-defined topology. The 2nd test case for optimization at single wavelength. In the next case, the dielectric material in scattering layer is replaced with high index dielectric (GaP), which is identical to the material used for the cladding layer. While the overall absorbing performance can be improved, the use of high-index dielectric material in the scattering layer leads to a more complicated optimization problem with multiple governing factors in effect. In this case, the scattering layer with proper spatial filling ratio of the dielectric material determines the reflection of the incident light due to the impe- dance mismatch and the simultaneous diffraction to the targeted slot waveguide modes. Due to the fact that the geometry (topology) change on the scattering layer has a significant influence on both diffraction and reflection, those two competing processes need to be addressed simultaneously during the design process. Competition between these two factors brings forth a large number of local optima, which unfortunately increases the complexity of solution space along with the large design dimensionality, all together resulting into the ill-posedness of the problem49, i.e. non-existence of solution. Moreover, as rooted in its stochastic characteristic, GA based NGTO is vulnerable to structural noise51 in that checkerboard patterns and redundant small scale features appear during optimization iterations and in the final results. They exhibit limited contribution to absorption enhancement while dramatically increase the difficulty in the device fabrication. To overcome the aforementioned numerical instabilities, we intro- duced the filtering technique34 into the GA based NGTO method. Inspired from the image processing field, filtering techniques have been wildly adopted in gradient based topology optimization34,52. During the density filtering process, the original field of design vari- ables is smoothened by modifying the value of design variable in each element according to its neighborhood values. The smoot- hened field is then converted into a binary-valued field by comparing with a threshold value53. While preserving the general geometric property, instable features are effectively removed after filtering. In Initial Random Pattern Optimization λ=400 nm Optimization λ=600 nm Optimization λ=500 nm Unit Cell 3 x 3 Cells Fourier Transform (a) (c) (b) (d) (g) (e) (f) (i) (h) (j) (k) (l) 0 300 Figure 3 | Results of the first optimization case, where the refractive index of the scattering dielectric material n51.7. Unit cell and 3|3 cells of the scattering pattern for three different wavelengths of incident light are shown with black and white denoting dielectric material and air, respectively. The Fourier transformation of the scattering patterns are calculated and two fundamental TM modes of the slot waveguide (1st TM mode: yellow and 2nd TM mode: blue) are plotted in Fourier space, indicating the mode coupling between incident light and guided modes in slot waveguide. (a) (b) (c) A typical scattering pattern in 1st generation of optimization. (d) (e) (f) Results of optimized scattering pattern for incident wavelength l 5 400 nm. (g) (h) (i) Results of optimized scattering pattern for incident wavelength l 5 400 nm. (j) (k) (l) Results of optimized scattering pattern for incident wavelength l 5 400 nm. Table 1 | Absorption coefficient of 1st generation and optimized patterns for incident wavelength l 5 400 nm, 500 nm and 600 nm Targeted Wavelength (nm) 400 500 600 Average absorption coefficient of 1st generation 0.012 0.011 0.016 Absorption coefficient of the optimized pattern 0.829 0.026 0.499 www.nature.com/scientificreports SCIENTIFIC REPORTS | 3 : 1025 | DOI: 10.1038/srep01025 4 the optimization process with density filtering as shown in Fig. 2(a), original element densities are referred to as design variables, and actual designs are presented in the form of filtered element densities that carry physical meanings. Observing the diagonal symmetry of optimized patterns shown in Fig. 3 under the polarization condition, the D4 symmetry was imposed to constraint the unit cell for faster optimization conver- gence. In this case, the design space is reduced to the area denoted by the dash-lined triangles in Fig. 4(a), (e) and (i). The optimized scat- tering patterns of the unit cell as well as the expanded domain con- sisting 333 unit cells for incident wavelength of 400 nm, 500 nm and 600 nm are shown in Figures 4(a) and (f), (b) and (i), (e) and (j), respectively. Optimized patterns obtained are of complicated topo- logy. To further illustrate the optimization results, Fourier trans- formation of each optimized pattern and two fundamental TM modes are shown in Fig. 4(c), (g) and (k), respectively. Mismatch of the scattering channels and slot waveguide modes is observed from the Fourier transformation, which reveals mode coupling condition is not fully satisfied. This manifests the fact that optimization in this case is a tradeoff between diffraction and reflection, leading to the complicated topology beyond the reach of parametric design. Absorption spectra for the scattering layer optimized at wavelength of 400 nm, 500 nm and 600 nm are shown in Fig. 4(d), (h) and (l), respectively. Distinctive absorption peaks at each target wavelength illustrate the effectiveness of the optimization. The absorption and enhancement factor of the optimized structure for each wavelength are shown in Table 2. The absorptions of all optimized designs are above 0.96, with the highest value reaching 0.99 without using the back reflector. These results reveal that both reflection and transmis- sion are eliminated and the whole diffraction energy is absorbed by the active layer through optimization. The enhancement factor, defined as the ratio between the total absorption and the single-path absorption for each wavelength, is shown in Table 2. Single-path absorption As:p:n00: 2p l :d, where n00 is the imaginary part of the refractive index of the active layer and d is the thickness of the active layer5. In this case, the enhancement factor of the optimized patterns achieved for each wavelength exceeds the Yablonovitch Limit, which is 7.22 without back reflector. Broadband optimization for solar spectrum. Finally, an optimi- zation of light trapping structure over the broad visible spectrum from 300 nm to 700 nm has been performed. Designing proper scattering patterns for broadband performance becomes even more complicated than for a single wavelength. As slot waveguide supports discrete resonances, the spectral absorption depends on Optimization λ=400 nm Optimization λ=600 nm Optimization λ=500 nm Unit Cell 3 x 3 Cells Fourier Transform 300 400 500 600 700 300 400 500 600 700 300 400 500 600 700 0 0.5 1 Absorption Spectrum (a) (c) (b) (d) (g) (e) (f) (i) (h) (j) (k) (l) Wavelength (nm) 0 0.5 1 0 0.5 1 0 300 Figure 4 | Results of the second optimization case, where the refractive index of the dielectric material in the scattering layer n51.7. Unit cell and 3|3 cell of the scattering pattern for three different wavelengths of incident light are shown with black and white denoting dielectric material and air, respectively. The Fourier transformation of the scattering patterns are calculated and two fundamental TM modes of the slot waveguide (1st TM mode: yellow and 2nd TM mode: blue) are plotted in Fourier space, indicating the mode coupling between incident light and guided modes in slot waveguide. The absorption spectrum from 300 nm to 700 nm of the optimized scattering pattern is presented. The red and blue dash lines indicate the targeted wavelength and average absorption coefficient, respectively. (a) (b) (c) (d) Results of optimized scattering pattern for incident wavelength l 5 400 nm. (e) (f) (g) (h) Results of optimized scattering pattern for incident wavelength l 5 500 nm. (i) (j) (k) (l) Results of optimized scattering pattern for incident wavelength l 5 600 nm. www.nature.com/scientificreports SCIENTIFIC REPORTS | 3 : 1025 | DOI: 10.1038/srep01025 5 contributions from the aggregated resonances. It is expected that the overall spectral absorption can be enhanced with the improve- ment of absorption of multiple wavelengths. Therefore, 31 wave- lengths evenly distributed in the spectrum are considered in this broadband optimization. The optimized pattern and the spectral absorption from 300 nm to 700 nm are shown in Fig. 5(a), (b) and (c). The average absorption over the whole spectrum reaches 0.481, with enhancement factor 24.4, which is above three times the Yablonovitch Limit at normal incidence. For comparison, the spectral absorption of the random scattering layer using the same material is depicted in Fig. 5(c). In contrast to both the strong coupling to slot waveguide modes and reduction of reflection from optimized scattering patterns, the random scattering pattern provides a continuum of wave vectors and results into much lower absorption 0.04 and enhancement factor 2.03, which is inferior to the Yablonovitch Limit. This demonstrates that without elaborate designs of the scattering layer, slot-waveguide based cells cannot exhibit superior spectral performance. Discussion In conclusion, we have extended the topology optimization method to designing light-trapping structure for thin-film cells. Slot-wave- guide based thin-film cell is selected as a test case optimized using the GA based NGTO, which is shown to be robust in achieving high- performance designs for problems with complex and highly non- linear solution spaces. The power of topology optimization method as a structural optimization tool has been demonstrated through the optimized structures of disparate topology for different optimization cases, such as the relatively simple nanowire structure4 in Figure 3 or more sophisticated patterns in Figure 4. Substantial enhancement in light absorption has been achieved for different cases, which is beyond the reach of physical intuition or designers experience and can only be obtained with the aid of the systematic design approach. Broadband optimization with simultaneous consideration of all governing factors over the solar spectrum brings forth a light-trap- ping structure with enhancement factor over three times the Yablonovitch limit. In the future work, solar spectrum weighted absorption can be assigned as objective function of the optimization. Moreover, it has been reported that structural randomness on dif- ferent length scales can also contribute to the broadband absorption enhancement54,55, yet they still need a systematic design approach. In this case, GTO can be implemented for achieving more innovative light-trapping structures with further performance improvement by accommodating more design freedom and extending design space to three dimensions. Methods Genetic Algorithm (GA). For the standard GA in this work, the tournament scheme that has been proved to be more favorable than others is used to perform the selection56 and the uniform crossover scheme appropriate for 2D topology optimization problems is adopted28. Values of the control parameters in this standard GA are determined according to the 3-step methodology57 to ensure a competent GA optimization. In this work the population size NP, i.e. the number of designs within one generation, is selected to be 23N (N is the number of design variables, i.e. discretized elements). The total number of evolving generation NG is set as 1.43NP and the elitism scheme is adopted that the best design within in the present generation is preserved to the next generation. The parameter s for tournament selection scheme, denoting the number of candidate designs in tournament selection, is chosen to be 2. The values of crossover probability Pc and mutation probability Pm are thus chosen to be s{1 ð Þ=s and 1=NP, respectively. In the second optimization case where the high-index dielectric material is used for the scattering layer, the density filtering technique34,53 is adopted. As Equation (2), the filtered density field ex carrying physical meanings is calculated as a convolution product of a filter function and the original density field x. The intermediate values produced by the filtering are then avoided by projecting the values above threshold value g to 1 and below g to 0. In this work, the filtering length scale r and the projection threshold g are set as 2 and 0.5, respectively. exe 1 X i[Ne Hei X i[Ne Heixi; Hei max 0,r{D e,i ð Þ ð Þ; ð2Þ Rigorous Coupled Wave Analysis (RCWA). The absorption is calculated by using RCWA method, which is one of the most commonly used techniques to solve the scattering problem of periodic dielectric structures in Fourier space. For the multilayered dielectric stacks, Fourier expansions of both the field and the permittivity lead to an algebraic eigenvalue system for each layer. The number of Fourier components considered in the optimization process is 13 by 13. The convergence test was performed on the selection of the diffraction order to ensure the Table 2 | Absorption coefficient and enhancement factor of opti- mized patterns for l 5 400 nm, 500 nm and 600 nm Wavelength (nm) 400 500 600 Absorption coefficient 0.964 0.985 0.991 Enhancement factor 39.61 50.67 60.78 Absorption Coefficient Wavelength (nm) Optimizated Design Random Pattern (a) (c) (b) Figure 5 | Results of optimal light trapping structure over the broad visible spectrum from 300 nm to 700 nm. 31 wavelengths evenly distributed in the spectrum are selected in this broadband optimization. (a) Unit cell of the optimized scattering pattern. (b) 3|3 cell of the optimized scattering pattern. (c) Absorption spectrum of the optimized scattering pattern (blue solid line) and a typical random scattering pattern (red solid line). Blue and red dash line represents average absorption coefficient of the optimized scattering pattern and the random pattern, respectively. www.nature.com/scientificreports SCIENTIFIC REPORTS | 3 : 1025 | DOI: 10.1038/srep01025 6 numerical accuracy. As the scattering layer is discretized by a 32|32 grid mesh, the Fourier components of the permittivity can be calculated by e kx,ky    1 32|32 X i,j1,...32|32 e xi,yj   e{i kxxizkyyi ð Þ ð3Þ The electromagnetic fields in each layer are determined by solving the eigenvalue problems. The scattering matrix algorithm (S matrix) is then applied on boundary conditions, leading to an S matrix for the configuration under investigation. Poynting theorem is implemented to yield reflection, transmission, and deflection and law of energy conservation implies AzRzTzDI; D X n=0 Rnz X n=0 Tn ð4Þ where I is the incidence, A is the absorption, R is the zeroth-order reflection, T is the zeroth-order transmission, and D is deflection, which includes higher order reflection and transmission. 1. Yablonovitch, E. Statistical ray optics. Journal of the Optical Society of America 72, 899907 (1982). 2. Stuart, H. R. & Hall, D. G. Thermodynamic limit to light trapping in thin planar structures. J Opt Soc Am A 14, 30013008 (1997). 3. Saeta, P. N., Ferry, V. E., Pacifici, D., Munday, J. N. & Atwater, H. A. How much can guided modes enhance absorption in thin solar cells? Opt Express 17, 2097520990 (2009). 4. Garnett, E. & Yang, P. D. Light Trapping in Silicon Nanowire Solar Cells. Nano Lett 10, 10821087 (2010). 5. Yu, Z. F., Raman, A. & Fan, S. H. Fundamental limit of nanophotonic light trapping in solar cells. P Natl Acad Sci USA 107, 1749117496 (2010). 6. Callahan, D. M., Munday, J. N. & Atwater, H. A. Solar Cell Light Trapping beyond the Ray Optic Limit. Nano Lett 12, 214218 (2012). 7. Dewan, R. et al. Light trapping in thin-film silicon solar cells with submicron surface texture. Opt Express 17, 2305823065 (2009). 8. Feng, N. N. et al. Design of highly efficient light-trapping structures for thin-film crystalline silicon solar cells. Ieee T Electron Dev 54, 19261933 (2007). 9. Chen, X. et al. Broadband Enhancement in Thin-Film Amorphous Silicon Solar Cells Enabled by Nucleated Silver Nanoparticles. Nano Lett (2012). 10. Raman, A., Yu, Z. F. & Fan, S. H. Dielectric nanostructures for broadband light trapping in organic solar cells. 2011 Conference on Lasers and Electro-Optics (Cleo) (2011). 11. Wang, K. X. Z., Yu, Z. F., Liu, V., Cui, Y. & Fan, S. H. Absorption Enhancement in Ultrathin Crystalline Silicon Solar Cells with Antireflection and Light-Trapping Nanocone Gratings. Nano Lett 12, 16161619 (2012). 12. Bermel, P., Luo, C., Zeng, L., Kimerling, L. C. & Joannopoulos, J. D. Improving thin-film crystalline silicon solar cell efficiencies with photonic crystals. Opt Express 15, 1698617000 (2007). 13. Mallick, S. B., Agrawal, M. & Peumans, P. Optimal light trapping in ultra-thin photonic crystal crystalline silicon solar cells. Opt Express 18, 56915706 (2010). 14. Atwater, H. A. & Polman, A. Plasmonics for improved photovoltaic devices. Nat Mater 9, 865865 (2010). 15. Schuller, J. A. et al. Plasmonics for extreme light concentration and manipulation. Nat Mater 9, 193204 (2010). 16. Wang, W., Wu, S. M., Reinhardt, K., Lu, Y. L. & Chen, S. C. Broadband Light Absorption Enhancement in Thin-Film Silicon Solar Cells. Nano Lett 10, 20122018 (2010). 17. Aydin, K., Ferry, V. E., Briggs, R. M. & Atwater, H. A. Broadband polarization- independent resonant light absorption using ultrathin plasmonic super absorbers. Nat Commun 2, (2011). 18. Liu, K. S. & Jiang, L. Bio-inspired design of multiscale structures for function integration. Nano Today 6, 155175 (2011). 19. Sanchez, C., Arribart, H. & Guille, M. M. G. Biomimetism and bioinspiration as tools for the design of innovative materials and systems. Nat Mater 4, 277288 (2005). 20. Min, W. L., Jiang, B. & Jiang, P. Bioinspired Self-Cleaning Antireflection Coatings. Adv Mater 20, 3914 (2008). 21. Stavenga, D. G., Foletti, S., Palasantzas, G. & Arikawa, K. Light on the moth-eye corneal nipple array of butterflies. P Roy Soc B-Biol Sci 273, 661667 (2006). 22. Vukusic, P. & Sambles, J. R. Photonic structures in biology. Nature 424, 852855 (2003). 23. Fuhrmann, T., Landwehr, S., El Rharbi-Kucki, M. & Sumper, M. Diatoms as living photonic crystals. Appl Phys B-Lasers O 78, 257260 (2004). 24. Bendsoe, M. P. & Kikuchi, N. Generating Optimal Topologies in Structural Design Using a Homogenization Method. Comput Method Appl M 71, 197224 (1988). 25. Bendsoe, M. P. & Sigmund, O. Topology Optimization. Theory, Methods, and Applications. 1st edn (Springer Verlag, 2003). 26. Rozvany, G. I. N. Aims, scope, methods, history and unified terminology of computer-aided topology optimization in structural mechanics. Struct Multidiscip O 21, 90108 (2001). 27. Jensen, J. S. & Sigmund, O. Topology optimization for nano-photonics. Laser Photonics Rev 5, 308321 (2011). 28. Shen, L. F., Ye, Z. & He, S. Design of two-dimensional photonic crystals with large absolute band gaps using a genetic algorithm. Phys Rev B 68, (2003). 29. Preble, S., Lipson, M. & Lipson, H. Two-dimensional photonic crystals designed by evolutionary algorithms. Appl Phys Lett 86, (2005). 30. Kao, C. Y., Osher, S. & Yablonovitch, E. Maximizing band gaps in two- dimensional photonic crystals by using level set methods. Appl Phys B-Lasers O 81, 235244 (2005). 31. Jensen, J. S. & Sigmund, O. Systematic design of photonic crystal structures using topology optimization: Low-loss waveguide bends. Appl Phys Lett 84, 20222024 (2004). 32. Gondarenko, A. et al. Spontaneous emergence of periodic patterns in a biologically inspired simulation of photonic structures. Phys Rev Lett 96, (2006). 33. Andkjaer, J. & Sigmund, O. Topology optimized low-contrast all-dielectric optical cloak. Appl Phys Lett 98, (2011). 34. Sigmund, O. Morphology-based black and white filters for topology optimization. Struct Multidiscip O 33, 401424 (2007). 35. Wang, M., Wang, X. M. & Guo, D. M. A level set method for structural topology optimization. Computer Methods in Applied Mechanics and Engineering 192, 227246 (2003). 36. Sokolowski, J. & Zochowski, A. On the topological derivative in shape optimization. Siam Journal on Control and Optimization 37, 12511272 (1999). 37. Wang, S. Y. & Tai, K. Structural topology design optimization using Genetic Algorithms with a bit-array representation. Comput Method Appl M 194, 37493770 (2005). 38. Shim, P. Y. & Manoochehri, S. Generating optimal configurations in structural design using simulated annealing. Int J Numer Meth Eng 40, 10531069 (1997). 39. Luh, G. C. & Lin, C. Y. Structural topology optimization using ant colony optimization algorithm. Appl Soft Comput 9, 13431353 (2009). 40. Holland, J. H. Adaptation in Natural and Artificial Systems. (The University of Michigan Press, Ann Arbor, 1975). 41. Goldberg, D. E. Genetic Algorithms in Search, Optimization, and Machine Learning. (Addison-Wesley Professional, 1989). 42. Sanchis, L., Hakansson, A., Lopez-Zanon, D., Bravo-Abad, J. & Sanchez-Dehesa, J. Integrated optical devices design by genetic algorithm. Appl Phys Lett 84, 44604462 (2004). 43. Jiang, J. H., Cai, J. B., Nordin, G. P. & Li, L. X. Parallel microgenetic algorithm design for photonic crystal and waveguide structures. Opt Lett 28, 23812383 (2003). 44. Li, L. F. New formulation of the Fourier modal method for crossed surface-relief gratings. J Opt Soc Am A 14, 27582767 (1997). 45. Moharam, M. G., Pommet, D. A., Grann, E. B. & Gaylord, T. K. Stable Implementation of the Rigorous Coupled-Wave Analysis for Surface-Relief Gratings - Enhanced Transmittance Matrix Approach. J Opt Soc Am A 12, 10771086 (1995). 46. Almeida, V. R., Xu, Q. F., Barrios, C. A. & Lipson, M. Guiding and confining light in void nanostructure. Opt Lett 29, 12091211 (2004). 47. Yu, Z. F., Raman, A. & Fan, S. H. Fundamental limit of light trapping in grating structures. Opt Express 18, A366A380 (2010). 48. Hoppe, H., Sariciftci, N. S. & Meissner, D. Optical constants of conjugated polymer/fullerene based bulk-heterojunction organic solar cells. Mol Cryst Liq Cryst 385, 233239 (2002). 49. Sigmund, O. & Peterson, J. Numerical instabilities in topology optimization: A survey on procedures dealing with checkerboards, mesh-dependencies and local minima. Structural and Multidisciplinary Optimization 16, 6875 (1998). 50. Zanotto, S., Liscidini, M. & Andreani, L. C. Light trapping regimes in thin-film silicon solar cells with a photonic pattern. Opt Express 18, 42604274 (2010). 51. Preble, S. F., Lipson, H. & Lipson, M. Novel two-dimensional photonic crystals designed by evolutionary algorithms. Nanophotonics for Communication: Materials and Devices 5597, 118128 (2004). 52. Sigmund, O. On the design of compliant mechanisms using topology optimization. Mech Struct Mach 25, 493524 (1997). 53. Bruns, T. E. & Tortorelli, D. A. Topology optimization of non-linear elastic structures and compliant mechanisms. Comput Method Appl M 190, 34433459 (2001). 54. Bao, H. & Ruan, X. L. Optical absorption enhancement in disordered vertical silicon nanowire arrays for photovoltaic applications. Opt Lett 35, 33783380 (2010). 55. Vynck, K., Burresi, M., Riboli, F. & Wiersma, D. S. Photon management in two- dimensional disordered media. Nat Mater advance online publication (2012). 56. Goldberg, D. E. & Deb, K. in Foundations of Genetic Algorithms 6993 (Morgan Kaufmann, 1991). 57. Reed, P., Minsker, B. & Goldberg, D. E. Designing a competent simple genetic algorithm for search and optimization. Water Resour Res 36, 37573761 (2000). Acknowledgements We thank Yi Xiong for providing the original RCWA code and Biqin Dong for fruitful discussion on optical simulations. This work is supported by the National Science Foundation under Grant number CMMI-1130640, CMMI-0955195, and CMMI-0751621. www.nature.com/scientificreports SCIENTIFIC REPORTS | 3 : 1025 | DOI: 10.1038/srep01025 7 Author contributions C.S. and W.C. initiated and supervised the project. C.W. performed the RCWA simulation and physical analysis and Y.S.C conducted the optimization. All authors discussed the results and contributed to the manuscript. Additional information Competing financial interests: The authors declare no competing financial interests. License: This work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-nd/3.0/ How to cite this article: Wang, C., Yu, S., Chen, W. & Sun, C. Highly Efficient Light-Trapping Structure Design Inspired By Natural Evolution. Sci. Rep. 3, 1025; DOI:10.1038/srep01025 (2013). www.nature.com/scientificreports SCIENTIFIC REPORTS | 3 : 1025 | DOI: 10.1038/srep01025 8